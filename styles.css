:root{
  /* 明るいアドベンチャーテーマ */
  --bg: #e0f7ff;
  --bg2:#f5ffe0;
  --card:#ffffffee;
  --text:#064e3b;
  --muted:#6b7280;
  --accent:#22c55e;
  --accent2:#facc15;
  --danger:#ef4444;
  --key:#f0f9ff;
  --keyBorder:#cbd5e1;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
  background:
    radial-gradient(1200px 600px at 80% -10%, #bfdbfe 0%, transparent 60%),
    radial-gradient(900px 500px at -10% 20%, #bbf7d0 0%, transparent 60%),
    linear-gradient(180deg,var(--bg),var(--bg2));
  color:var(--text);
}

/* === ヘッダー === */
.app-header{
  position:sticky; top:0; z-index:10;
  display:flex; align-items:center; justify-content:space-between;
  gap:12px;
  padding:10px 12px;
  background:#e0f2fec8;
  backdrop-filter: blur(8px);
  border-bottom:1px solid #bae6fd;
}
.hdr-left{min-width:0; flex:1 1 auto}
.hdr-right{
  display:flex; flex-wrap:nowrap; gap:8px;
  flex:0 0 auto; white-space:nowrap;
}
.brand{font-weight:800; letter-spacing:0.02em}

.btn{
  -webkit-tap-highlight-color: transparent;
  background:#e0f2fe; color:var(--text);
  border:1px solid #bfdbfe;
  padding:10px 14px; border-radius:999px;
  font-size:16px; line-height:1; cursor:pointer;
}
.btn:hover{filter:brightness(1.05)}
.btn.primary{
  background:linear-gradient(180deg,#34d399,#22c55e);
  border-color:#16a34a;
  color:#022c22;
}
.btn.ghost{background:#e0f2fe80}
.btn.block{width:100%}

/* モバイルでボタンが折り返さないように少し小さく */
@media (max-width:480px){
  .brand{font-size:15px}
  .app-header .btn{padding:8px 10px; font-size:14px}
}

.container{max-width:720px; margin:16px auto 24px; padding:0 12px}

/* === もんだい数モード === */
.mode-bar{
  display:flex; align-items:center; gap:8px;
  margin-bottom:6px; font-size:14px;
}
.mode-label{color:var(--muted); white-space:nowrap;}
.mode-buttons{
  display:flex; gap:6px; flex-wrap:nowrap;
}
.mode-btn{
  border-radius:999px; border:1px solid #e5e7eb;
  background:#f9fafb; color:#374151;
  padding:6px 10px; font-size:13px; cursor:pointer;
}
.mode-btn.active{
  background:#22c55e; color:#022c22; border-color:#16a34a;
}

/* === ステータス === */
.status-bar{
  display:flex; justify-content:space-between; align-items:center;
  margin:4px 0 10px; color:var(--muted); font-weight:600;
}

/* === 恐竜＆スター === */
.buddy-bar{
  display:flex; flex-wrap:wrap; gap:10px;
  margin-bottom:12px;
}
.buddy{
  flex:1 1 55%;
  display:flex; align-items:center; gap:8px;
  padding:8px 10px;
  background:#fefce8;
  border-radius:14px;
  border:1px solid #fde68a;
  box-shadow:0 3px 6px rgba(0,0,0,.05);
}
.dino{font-size:36px}
.dino-text{font-size:13px}
.dino-msg{color:#6b7280; margin-top:2px}
#dinoName{font-weight:700}

.star-bar{
  flex:1 1 40%;
  padding:8px 10px;
  background:#eff6ff;
  border-radius:14px;
  border:1px solid #bfdbfe;
  display:flex; flex-direction:column; gap:6px;
  box-shadow:0 3px 6px rgba(0,0,0,.05);
}
.star-label{font-size:13px; color:#1d4ed8; font-weight:700}
.star-track{
  position:relative;
  width:100%; height:10px;
  border-radius:999px;
  background:#e5e7eb;
  overflow:hidden;
}
.star-fill{
  position:absolute; inset:0;
  width:0%;
  background:linear-gradient(90deg,#facc15,#fb923c);
  transition:width .4s ease-out;
}

/* === カード === */
.card{
  background:var(--card);
  border:1px solid #e5e7eb;
  border-radius:18px;
  padding:16px;
  box-shadow: 0 12px 30px rgba(15,23,42,.12);
}
.hidden{display:none}

.q-label{color:var(--muted); font-size:14px}
.question{
  display:flex; align-items:center; gap:10px;
  font-size:40px; letter-spacing:.02em; margin-top:6px;
}
.ansbox{
  display:inline-block; min-width:56px; padding:4px 8px;
  border-bottom:3px dashed #d4d4d4; text-align:center;
  font-variant-numeric: tabular-nums;
  background:#e5e7eb;
  border-radius:8px;
}

/* === キーパッド === */
.pad{margin-top:14px}
.pad-grid{display:grid; grid-template-columns:repeat(3,1fr); gap:10px}
.key{
  padding:16px 0;
  border-radius:16px;
  border:2px solid var(--keyBorder);
  background:radial-gradient(140% 80% at 50% -10%, #ffffff,#e0f2fe);
  color:#0f172a;
  font-size:22px; line-height:1;
  font-weight:600;
  box-shadow: inset 0 2px 0 rgba(255,255,255,0.8), 0 3px 0 rgba(148,163,184,0.7);
}
.key.wide{grid-column: span 2}
.key.danger{
  background:radial-gradient(140% 80% at 50% -10%, #fee2e2,#fecaca);
  border-color:#fca5a5;
  color:#7f1d1d;
}
.key:active{transform:translateY(1px); box-shadow:0 1px 0 rgba(148,163,184,0.7)}

.actions{display:flex; justify-content:center; margin-top:16px}

/* === エフェクト === */
.fx{
  min-height:32px;
  display:flex; align-items:center; justify-content:center;
  font-size:22px; font-weight:900; margin-top:4px;
}
.fx.ok{color:var(--accent2); text-shadow:0 0 8px rgba(250,204,21,.7); animation: pop .9s ease}
.fx.ng{color:var(--danger); animation: shake 1.1s ease}
@keyframes pop{
  0%{transform:scale(.7);opacity:.2}
  80%{transform:scale(1.06);opacity:1}
  100%{transform:scale(1);opacity:1}
}
@keyframes shake{
  0%,100%{transform:translateX(0)}
  20%{transform:translateX(-7px)}
  60%{transform:translateX(7px)}
}

/* 正解時のスターアニメーション */
.starburst{
  position:fixed;
  top:50%; left:50%;
  transform:translate(-50%,-50%) scale(0.5);
  font-size:56px;
  pointer-events:none;
  animation:burst 1s ease-out forwards;
}
@keyframes burst{
  0%{transform:translate(-50%,-30%) scale(0.4); opacity:0;}
  40%{transform:translate(-50%,-80%) scale(1.2); opacity:1;}
  100%{transform:translate(-50%,-120%) scale(0.2); opacity:0;}
}

/* 結果 */
.big{font-size:24px; margin-top:8px}
#summaryList{margin-top:12px; color:var(--muted); font-size:14px}
#summaryList .ok{color:var(--accent); font-weight:700}
#summaryList .ng{color:var(--danger); font-weight:700}

/* モーダル（九九表） */
.modal{position:fixed; inset:0; display:grid; place-items:center}
.modal.hidden{display:none}
.modal-backdrop{position:absolute; inset:0; background:#00000055}
.modal-content{
  position:relative; z-index:1; width:min(900px,92vw);
  background:#ffffff;
  border:2px solid #bfdbfe;
  border-radius:16px; padding:16px;
  max-height:85vh; overflow:auto;
}

/* 九九表（列×行：上=段, 左=かける数） */
.kuku-grid{
  overflow-x:auto;
  border:1px solid #e5e7eb; border-radius:12px; padding:8px;
  background:#f8fafc;
}
.kuku-table{
  border-collapse:separate; border-spacing:6px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  font-size:14px;
}
.kuku-table th, .kuku-table td{
  background:#ffffff;
  border:1px solid #e5e7eb;
  color:#111827;
  border-radius:8px; padding:6px 8px; text-align:center; white-space:nowrap;
}
.kuku-table th.hd{color:#1d4ed8; background:#dbeafe}
.kuku-table td.expr{letter-spacing:.02em}

/* モバイル微調整 */
@media (hover:none){
  .btn{padding:12px 14px; font-size:16px}
  .question{font-size:36px}
  .kuku-table{font-size:13px}
}